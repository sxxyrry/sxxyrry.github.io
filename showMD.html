<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
  <script src="./package/Marked/code/marked.umd.js"></script>
  <link rel="stylesheet" href="./assets/fonts/sliced/SarasaMonoSC/font.css">
  <style>
    body {
      background: #181818;
      margin: 10px;
      font-family: 'SarasaMonoSC-ExtraLightItalic';
    }

    * {
      color: #dbe2fa;
      font-family: 'SarasaMonoSC-ExtraLightItalic';
    }

    #MDContent {
      min-height: 4vh;
      max-height: 50vh;
      overflow: scroll;
      border-radius: 8px;
      border: #42446b solid 1px;
      /* 自动换行 */
      /* word-wrap: break-word;
      word-break: break-word;
      white-space: pre-wrap; */
    }

    #MDContent::-webkit-scrollbar {
      width: 8px;
    }

    #MDContent::-webkit-scrollbar-track {
      background: #181818;
      border-radius: 4px;
    }

    #MDContent::-webkit-scrollbar-thumb {
      background: #42446b;
      border-radius: 4px;
    }

    #MDContent::-webkit-scrollbar-thumb:hover {
      background: #5e4499;
    }

    blockquote {
      background: #3f3f3f;
      border-radius: 8px;
      padding-left: 4vw;
      margin: 0;
      position: relative;
    }

    blockquote::after {
      content: '';
      /* background: #8b8dee; */
      background: #353535;
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 3.5vw;
      height: 100%;
      /* border-radius: 8px 0 0 8px; */
      border-radius: 8px;
    }

    /* ul li {
      margin: -3vh 0 -3vh 0;
    } */

    li p {
      margin-bottom: 0;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      margin: 0;
    }
    </style>
</head>
<body>
  <pre id="MDContent"></pre>

  <script type="module">
function getBase64DecodedContent(paramName) {
    const url = new URL(location.href);
    let encodedContent = url.searchParams.get(paramName);
    
    if (!encodedContent) {
        throw new Error(`参数 ${paramName} 不存在`);
    }
    
    // 解码 URL 参数，将 %xx 编码的字符转换回原始字符
    encodedContent = decodeURIComponent(encodedContent);
    
    // 移除空白字符
    encodedContent = encodedContent.replace(/\s/g, '');

    // 确保字符串是有效的 Base64 格式
    // 将 URL 安全的 Base64 的 - 替换为 +，_ 替换为 /
    let base64Content = encodedContent.replace(/-/g, '+').replace(/_/g, '/');
    
    // 确保 Base64 字符串长度是 4 的倍数，补上等号
    while (base64Content.length % 4 !== 0) {
         base64Content += '=';
    }

    // 验证 Base64 字符串只包含有效的 Base64 字符
    const validBase64Regex = /^[A-Za-z0-9+/=]+$/;
    if (!validBase64Regex.test(base64Content)) {
        throw new Error('Base64 编码无效');
    }

    // 将 Base64 解码为原始内容
    const binaryData = atob(base64Content);
    // 将二进制数据转换为字符串（处理 UTF-8）
    let bytes = new Uint8Array(binaryData.length);
    for (let i = 0; i < binaryData.length; i++) {
        bytes[i] = binaryData.charCodeAt(i);
    }
    return new TextDecoder('utf-8').decode(bytes);
}

    // const url = new URL(location.href)
    const content = getBase64DecodedContent('content')
    
    if (content) {
      document.getElementById('MDContent').innerHTML = marked.parse(content)
    } else {
      document.getElementById('MDContent').innerHTML = '未知内容'
    }
  </script>
</body>
</html>