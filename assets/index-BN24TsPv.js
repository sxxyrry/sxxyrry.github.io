import{r as g,c as y,a as l,z as F,y as R,A as V,b as x}from"./ElseDependent-Q8CVMjsT.js";import{_ as L}from"./index-CEUacyVH.js";const N=["href"],z={__name:"index",setup(E){document.title="图片转像素画";const b=g(null),s=g(null),d=g(10),c=g(null),I=()=>{b.value.click()},w=async o=>{if(d.value%1!==0){await k("像素大小必须为整数");return}const e=o.target.files[0];if(!e)return;const a=new FileReader;a.onload=r=>{const t=new Image;t.onload=()=>{const n=s.value.getContext("2d");s.value.width=t.width,s.value.height=t.height,n.drawImage(t,0,0),D(n,t.width,t.height,d.value),c.value=s.value.toDataURL("image/png")},t.src=r.target.result},a.readAsDataURL(e)},k=o=>new Promise(e=>{alert(o),e()}),D=(o,e,a,r)=>{const t=o.getImageData(0,0,e,a),n=t.data;for(let u=0;u<a;u+=r)for(let i=0;i<e;i+=r){const p=(u*e+i)*4,C=n[p],U=n[p+1],A=n[p+2],B=n[p+3];for(let f=0;f<r;f++)for(let m=0;m<r;m++)if(u+f<a&&i+m<e){const v=((u+f)*e+(i+m))*4;n[v]=C,n[v+1]=U,n[v+2]=A,n[v+3]=B}}o.putImageData(t,0,0)};return(o,e)=>(x(),y("div",null,[e[1]||(e[1]=l("h1",null,"图片转像素画",-1)),l("button",{onClick:I},"选择文件"),l("input",{type:"file",ref_key:"fileInput",ref:b,accept:"image/*",style:{display:"none"},onChange:w},null,544),e[2]||(e[2]=l("br",null,null,-1)),e[3]||(e[3]=l("br",null,null,-1)),e[4]||(e[4]=l("label",{for:"pixelSizeInput"},"像素大小",-1)),F(l("input",{type:"number",id:"pixelSizeInput","onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),min:"1"},null,512),[[V,d.value,void 0,{number:!0}]]),e[5]||(e[5]=l("br",null,null,-1)),e[6]||(e[6]=l("br",null,null,-1)),l("canvas",{ref_key:"canvas",ref:s},null,512),e[7]||(e[7]=l("br",null,null,-1)),e[8]||(e[8]=l("br",null,null,-1)),c.value?(x(),y("a",{key:0,href:c.value,download:"pixel_art.png",class:"download-btn"}," 下载像素画 ",8,N)):R("",!0)]))}},T=L(z,[["__scopeId","data-v-c4fcbf86"]]);export{T as default};
